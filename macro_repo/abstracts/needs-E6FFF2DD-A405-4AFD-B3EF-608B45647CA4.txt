"The proportion of computer science (CS) bachelor's degree recipients who are women has consistently been small and is declining. This study investigates factors that predict performance and persistence in an undergraduate CS program and explores why even high-achieving students leave the undergraduate "CS pipeline." The factors that predict achievement and retention sometimes interact in complex, unexpected ways. Male students who earned less than a B in an introductory CS course were more likely to take the next course in the curriculum than were women who earned less than a B. Achievement is a factor in even high-achieving students' decision to leave CS; loss of interest can accompany loss of confidence. Level of achievement was predicted by various background factors including Scholastic Aptitude Test scores, the number of Calculus courses taken before entering the CS program, amount of access to a computer at home, prior computing experience, and having a mentor or role model during high school. Most of these factors also predicted persistence beyond the first two courses required for a CS major. Curiously, women in the introductory CS course who reported having low exposure to specific programming skills outperformed women who reported having a high level of programming experience. The reverse was true of men. Further investigation provided evidence that women who develop programming skills while in high school might do so at the expense of developing other skills that strongly predict CS achievement, particularly math skills."